# Thumb Drive(Malware)
#### Zorluk: Medium

## Soru
![Soru](https://github.com/mel4mi/Huntress2023-Writeups/blob/main/Depo/Malware/Thumb_Drive/Thumb_Drive.png)

## Çözüm
Bad USB örneği olarak ADATA_128GB.download adında bir dosya verildi ve ilk iş olarak string değerlerine bakmaya koyuldum. Strings toolunu kullanarak değerlerine baktığımda cmd.exe çalıştırdığını ve bir http sayfasına yönlendirildiğini gördüm.

![Soru](https://github.com/mel4mi/Huntress2023-Writeups/blob/main/Depo/Malware/Thumb_Drive/Thumb_drive1.PNG)

Sayfayı arattığımda bir usb.txt isminde bir dosya karşıma çıktı. Dosyayı indirdim ve içerisinde Base64 ile encode edilmiş bir değer olduğu için CyberChef'e attım. Decode ettiğinde aslında encode edilen değerin bir Windows çalıştırılabilir dosyası olduğunu anladım. 

![Soru](https://github.com/mel4mi/Huntress2023-Writeups/blob/main/Depo/Malware/Thumb_Drive/Thumb_drive2.PNG)

Dosyayı indirip baktığımda bir dll dosyası olduğunu anladım. Rundll32.exe ile dll dosyasını çalıştırdığımda flagı elde ettim.

```rundll32.exe Download.dll 1 ```

![Soru](https://github.com/mel4mi/Huntress2023-Writeups/blob/main/Depo/Malware/Thumb_Drive/Thumb_drive3.PNG)

```flag{0af2873a74cfa957ccb90cef814cfe3d}```
