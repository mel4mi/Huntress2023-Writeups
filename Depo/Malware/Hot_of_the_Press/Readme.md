# Hot Off The Press(Malware)
#### Zorluk: Medium

## Soru
![Soru](https://github.com/mel4mi/Huntress2023-Writeups/blob/main/Depo/Malware/Hot_of_the_Press/Hot_Off_The_Press.png)

## Çözüm
Bize uhc uzantılı bir dosya verilmiş. Uhc uzantılı dosyalar sıkıştırılmış bir dosyadır bu yüzden dosyanın içeriğini çıkartabilmek için UHARC uygulamasını kullandım. UHARC/GUI uygulaması üzerinde baktığımda dosyanın içerisinde bir Powershell dosyası olduğunu gördüm.

![Soru](https://github.com/mel4mi/Huntress2023-Writeups/blob/main/Depo/Malware/Hot_of_the_Press/HOTP1.PNG)

Powershell dosyasını çıkarttım ve Notepad++ ile açtım. Çıkan ekranda bir Powershell komutu ve obfuscate edilmiş değerler vardı. 

![Soru](https://github.com/mel4mi/Huntress2023-Writeups/blob/main/Depo/Malware/Hot_of_the_Press/HOTP2.PNG)

Dosyayı biraz daha incelediğimizde ise aşağıda base64 kodu olduğunu gördüm. Base64 kodunun arasına "+", {0}, {1} gibi değerler eklenmişti. {0} değerinin "L" harfini, {1} değerinin ise "E" harfinin yerini tuttuğunu gördüm ve değiştirip base64 değerini elde ettim.

![Soru](https://github.com/mel4mi/Huntress2023-Writeups/blob/main/Depo/Malware/Hot_of_the_Press/HOTP3.PNG)

Elde ettiğim değeri CyberChef sitesine attığımda ise bunun Gzip ile sıkıştırıldığı gördüm ve Gunzip seçeneğini kullanarak değeri decode ettim.

![Soru](https://github.com/mel4mi/Huntress2023-Writeups/blob/main/Depo/Malware/Hot_of_the_Press/HOTP4.PNG)

Decode ettiğim değerde tekrardan bir base64 ile encode edilmiş bir değer vardı ve onu da yine CyberChef üzerinden decode ettim.

![Soru](https://github.com/mel4mi/Huntress2023-Writeups/blob/main/Depo/Malware/Hot_of_the_Press/HOTP5.PNG)

Decode işleminin sonucunda bir http adresi ve encoded_flag adlı bir değişken bulunmaktaydı. Encoded_flag değişkeninin değerini de decode ettiğimde flagı elde ettim.

![Soru](https://github.com/mel4mi/Huntress2023-Writeups/blob/main/Depo/Malware/Hot_of_the_Press/HOTP6.PNG)

```flag{dbfe5f755a898ce5f2088b0892850bf7}```
